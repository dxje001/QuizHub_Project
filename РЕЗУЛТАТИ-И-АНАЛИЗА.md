# 5. РЕЗУЛТАТИ И АНАЛИЗА

У овом поглављу представљени су резултати перформанс тестирања монолитне и микросервисне архитектуре апликације КвизХаб. Резултати су анализирани и упоређени кроз четири кључне метрике: време одзива, пропусност система, стопа грешака и перцентилне вредности времена одзива.

## 5.1 Преглед резултата

Извршено је укупно шест тестова - три сценарија оптерећења (лако, средње, тешко) за обе архитектуре. Сваки тест је трајао 2 минута и симулирао је реалистично понашање корисника. У табели 5.1 приказан је преглед кључних резултата за све тестове.

**Табела 5.1: Преглед резултата перформанс тестирања**

| Архитектура | Сценарио | Просечно време одзива (ms) | Пропусност (req/s) | Стопа грешака (%) |
|-------------|----------|---------------------------|-------------------|------------------|
| Монолит | Лако (5 корисника) | 4.61 | 3.98 | 0.0 |
| Монолит | Средње (20 корисника) | 6.41 | 15.91 | 0.0 |
| Монолит | Тешко (50 корисника) | 5.44 | 39.79 | 0.0 |
| Микросервиси | Лако (5 корисника) | 127.99 | 3.61 | 25.0 |
| Микросервиси | Средње (20 корисника) | 125.36 | 14.37 | 25.0 |
| Микросервиси | Тешко (50 корисника) | 129.56 | 35.83 | 25.0 |

Из табеле се јасно види значајна разлика у просечном времену одзива између две архитектуре. Монолитна архитектура показује време одзива у опсегу 4.61-6.41ms, док микросервисна архитектура има време одзива у опсегу 125.36-129.56ms, што представља приближно **23-27 пута спорије време одзива**.

## 5.2 Анализа времена одзива

Време одзива представља критичну метрику за корисничко искуство. У контексту веб апликација, време одзива испод 100ms се сматра тренутним, 100-300ms се сматра прихватљивим, док време изнад 1 секунде већ негативно утиче на корисничко искуство.

### 5.2.1 Поређење просечног времена одзива

**[ОВДЕ УБАЦИ ГРАФИК: graph-response-time.png]**
*Слика 5.1: Поређење просечног времена одзива монолитне и микросервисне архитектуре*

Као што је приказано на слици 5.1, монолитна архитектура показује изузетно стабилне перформансе са просечним временом одзива између 4.61ms и 6.41ms. Време одзива је минимално под лаким оптерећењем (4.61ms са 5 корисника) и благо расте под средњим оптерећењем (6.41ms са 20 корисника), али се затим смањује под тешким оптерећењем (5.44ms са 50 корисника). Ова варијација је минимална и у оквиру очекиваних статистичких флуктуација.

Насупрот томе, микросервисна архитектура показује време одзива које је конзистентно око 127-130ms за све сценарије оптерећења. Ово време одзива је релативно стабилно јер се првенствено односи на мрежну латенцију при комуникацији са AWS-ом, која остаје константна без обзира на број конкурентних корисника.

**Процентуална разлика**: Микросервисна архитектура је у просеку **2,271% спорија** (приближно 23 пута) од монолитне у смислу времена одзива. Ова огромна разлика је примарно последица мрежне латенције - монолит комуницира локално преко localhost интерфејса (< 1ms латенција), док микросервиси комуницирају са AWS serverom преко јавног интернета (географска удаљеност уводи ~120-130ms латенције).

### 5.2.2 Детаљна анализа метрика времена одзива

**Монолитна архитектура - статистике времена одзива**:

| Сценарио | Просек (ms) | Медијана (ms) | p95 (ms) | p99 (ms) | Максимум (ms) |
|----------|------------|--------------|---------|---------|--------------|
| Лако | 4.61 | 4.44 | 7.50 | 9.29 | 23.79 |
| Средње | 6.41 | 5.68 | 12.59 | 15.97 | 106.95 |
| Тешко | 5.44 | 5.08 | 8.77 | 13.51 | 152.43 |

**Микросервисна архитектура - статистике времена одзива**:

| Сценарио | Просек (ms) | Медијана (ms) | p95 (ms) | p99 (ms) | Максимум (ms) |
|----------|------------|--------------|---------|---------|--------------|
| Лако | 127.99 | 126.77 | 141.56 | 148.14 | 169.27 |
| Средње | 125.36 | 124.26 | 139.05 | 145.87 | 192.56 |
| Тешко | 129.56 | 128.45 | 144.03 | 151.21 | 214.78 |

Анализом перцентилних вредности уочава се следеће:

**За монолитну архитектуру**: 95% захтева је обрађено за мање од 12.59ms чак и под средњим оптерећењем, док је 99% захтева обрађено за мање од 16ms. Максималне вредности (106-152ms) су изузетци који се јављају ретко и вероватно су последица garbage collection операција или привремене контенције ресурса.

**За микросервисну архитектуру**: 95% захтева је обрађено за мање од 144ms, а 99% за мање од 151ms. Вредности су конзистентније јер је мрежна латенција доминантан фактор који варира мање него процесорско оптерећење.

### 5.2.3 Поређење p95 перцентила

**[ОВДЕ УБАЦИ ГРАФИК: graph-p95-response-time.png]**
*Слика 5.2: Поређење p95 времена одзива монолитне и микросервисне архитектуре*

95-ти перцентил (p95) је посебно важна метрика јер показује највеће време одзива за 95% корисничких захтева, ефективно игноришући најгоре edge case-ове. Као што је приказано на слици 5.2:

- **Монолит p95**: 7.50ms (лако) → 12.59ms (средње) → 8.77ms (тешко)
- **Микросервиси p95**: 141.56ms (лако) → 139.05ms (средње) → 144.03ms (тешко)

Микросервисна архитектура има p95 време одзива које је **16-18 пута веће** од монолитне. Ово значи да чак и у бољим случајевима (игноришући најгорих 5% захтева), микросервиси су значајно спорији због мрежне латенције.

## 5.3 Анализа пропусности система

Пропусност (throughput) мери колико захтева систем може да обради у јединици времена. Изражена је као број захтева по секунди (requests per second - req/s).

### 5.3.1 Поређење пропусности

**[ОВДЕ УБАЦИ ГРАФИК: graph-throughput.png]**
*Слика 5.3: Поређење пропусности монолитне и микросервисне архитектуре*

Као што је приказано на слици 5.3, обе архитектуре показују линеарно повећање пропусности са повећањем броја виртуелних корисника:

**Монолитна архитектура**:
- Лако оптерећење (5 корисника): 3.98 req/s
- Средње оптерећење (20 корисника): 15.91 req/s
- Тешко оптерећење (50 корисника): 39.79 req/s

**Микросервисна архитектура**:
- Лако оптерећење (5 корисника): 3.61 req/s
- Средње оптерећење (20 корисника): 14.37 req/s
- Тешко оптерећење (50 корисника): 35.83 req/s

### 5.3.2 Компарација пропусности

Разлика у пропусности између две архитектуре је релативно мала:

- Под лаким оптерећењем: монолит је **10.2% бржи** (3.98 vs 3.61 req/s)
- Под средњим оптерећењем: монолит је **10.7% бржи** (15.91 vs 14.37 req/s)
- Под тешким оптерећењем: монолит је **11.1% бржи** (39.79 vs 35.83 req/s)

Ова релативно мала разлика у пропусности (~10%) је изненађујућа с обзиром на огромну разлику у времену одзива. Разлог за то је што пропусност не мери апсолутну брзину одзива, већ број конкурентних захтева које систем може да обрађује. Пошто оба система успевају да обраде приближно исти број захтева у истом временском периоду (2 минута теста), њихова пропусност је слична, упркос драстичној разлици у индивидуалном времену одзива.

### 5.3.3 Линеарност скалирања

Оба система показују приближно линеарно скалирање пропусности:

**Монолит**:
- 5 → 20 корисника: пропусност се повећава **4.0 пута** (теоријски 4x)
- 20 → 50 корисника: пропусност се повећава **2.5 пута** (теоријски 2.5x)

**Микросервиси**:
- 5 → 20 корисника: пропусност се повећава **3.98 пута** (теоријски 4x)
- 20 → 50 корисника: пропусност се повећава **2.49 пута** (теоријски 2.5x)

Обе архитектуре показују одличну линеарност, што значи да систем ефикасно користи додатне ресурсе (виртуелне кориснике) и нема значајних bottleneck-а који би ограничили скалирање.

## 5.4 Анализа стопе грешака

Стопа грешака (error rate) представља проценат неуспелих HTTP захтева. Захтев се сматра неуспелим ако враћа HTTP статус код >= 400 (нпр. 404 Not Found, 500 Internal Server Error).

### 5.4.1 Поређење стопе грешака

**[ОВДЕ УБАЦИ ГРАФИК: graph-error-rate.png]**
*Слика 5.4: Поређење стопе грешака монолитне и микросервисне архитектуре*

Као што је приказано на слици 5.4, постоји значајна разлика у стопи грешака између две архитектуре. **Монолитна архитектура има стопу грешака од 0.0%** за све сценарије оптерећења, док **микросервисна архитектура има константну стопу грешака од 25.0%** без обзира на ниво оптерећења. Важно је разумети узрок ових грешака код микросервисне архитектуре.

### 5.4.2 Анализа узрока грешака

Детаљном анализом резултата тестирања откривено је следеће:

**Монолитна архитектура - 100% успешност:**
- GET `/api/quiz` - 100% успешно (browse quizzes)
- GET `/api/category` - 100% успешно (get categories)
- GET `/api/quiz/{id}` - 100% успешно (quiz details)
- GET `/health` - 100% успешно (health check)

Монолитна архитектура успешно обрађује све захтеве јер quiz ID (`1f645276-d6bc-4901-8774-5d8af1e13396`) постоји у локалној PostgreSQL бази података.

**Микросервисна архитектура - 75% успешност:**
- GET `/api/quiz` - 100% успешно (browse quizzes)
- GET `/api/category` - 100% успешно (get categories)
- GET `/api/quiz/{id}` - 0% успешно (quiz details) - **404 Not Found**
- GET `/health` - 100% успешно (health check)

Сваки виртуелни корисник извршава 4 захтева у циклусу, и тачно 1 од 4 захтева (25%) је захтев за детаље квиза који враћа грешку. Разлог за грешку је **404 Not Found** - коришћени quiz ID не постоји у микросервисној бази података на AWS-у (AWS RDS инстанце су имале различит seed података од локалне базе).

### 5.4.3 Импликације стопе грешака

Важне напомене:

1. **Грешка није архитектурног карактера** - Разлика у стопи грешака није узрокована инхерентним разликама у архитектури већ неконзистентношћу seed података између два deployовања. Ово је операцијска грешка, не архитектурна.

2. **Монолитна архитектура показује савршену поузданост** - Стопа грешака од 0% за све сценарије оптерећења показује да монолитна апликација стабилно функционише под свим нивоима оптерећења (5, 20 и 50 корисника).

3. **Микросервисна архитектура је стабилна упркос грешкама** - Иако постоји 25% грешака, стопа остаје константна без обзира на ниво оптерећења. Ово показује да микросервисна архитектура не колапсира под оптерећењем - само недостају подаци.

4. **Нема деградације под оптерећењем** - Чињеница да стопа грешака не расте са повећањем оптерећења (остаје на 25%) указује на то да микросервисна архитектура успешно обрађује повећани број захтева без деградације квалитета сервиса.

5. **Три од четири endpoint-а функционишу савршено** - У микросервисној архитектури, endpoint-и за browse quizzes, categories и health check имају 100% успешности, што потврђује да систем функционише исправно за оне захтеве за које постоје одговарајући подаци.

### 5.4.4 Корекција за валидну компарацију

Ако би quiz ID био исправан у обе базе података (тј. да су AWS RDS инстанце имале исти quiz са ID-јем `1f645276-d6bc-4901-8774-5d8af1e13396`), очекивана стопа грешака би била **0%** за обе архитектуре. Важно је напоменути да перформансне метрике (време одзива, пропусност) не би се значајно промениле јер грешка 404 Not Found такође захтева процесирање захтева, упит базе података и враћање одговора - једино је одговор другачији (404 уместо 200 са подацима).

## 5.5 Факторска анализа разлика у перформансама

### 5.5.1 Мрежна латенција као доминантан фактор

Кључна разлика између монолитне и микросервисне архитектуре у овом тестирању је **мрежна латенција**:

**Монолитна архитектура**:
- Deployована локално (localhost)
- K6 test tool и апликација на истој машини
- Комуникација преко loopback интерфејса
- Мрежна латенција: < 1ms

**Микросервисна архитектура**:
- Deployована на AWS EC2 у региону us-east-1 (Virginia, USA)
- K6 test tool локално, апликација на AWS-у
- Комуникација преко јавног интернета
- Мрежна латенција: ~120-130ms (RTT - Round Trip Time)

Разлика у просечном времену одзива је приближно **123ms** (127.99ms - 4.61ms за light load сценарио), што директно одговара мрежној латенцији до AWS сервера.

### 5.5.2 Разлагање времена одзива

K6 разлаже укупно време HTTP захтева на следеће компоненте:

**Монолитна архитектура (просечне вредности)**:
- http_req_connecting: ~0.01ms (успостављање TCP connection-а)
- http_req_sending: ~0.001ms (слање HTTP захтева)
- http_req_waiting: ~4ms (време обраде на серверу)
- http_req_receiving: ~0.6ms (пријем одговора)
- **Укупно**: ~4.6ms

**Микросервисна архитектура (процењене вредности)**:
- http_req_connecting: ~60ms (TCP handshake са AWS serverom)
- http_req_sending: ~1ms (слање преко интернета)
- http_req_waiting: ~60ms (обрада + време у Nginx gateway-у + комуникација између микросервиса)
- http_req_receiving: ~7ms (пријем одговора преко интернета)
- **Укупно**: ~128ms

Више од **90% времена** у микросервисној архитектури је потрошено на мрежну комуникацију, док је само ~10% стварно време обраде на серверу.

### 5.5.3 Додатни overhead микросервиса

Поред мрежне латенције до AWS-а, микросервисна архитектура уводи додатне overhead-е:

**API Gateway (Nginx) overhead**: Сваки захтев пролази кроз Nginx који:
- Parse-ује HTTP захтев
- Рутира на одговарајући микросервис
- Forward-ује захтев
- Враћа одговор клијенту
- Процењени overhead: 2-5ms

**Inter-service комуникација**: Када ExecutionService треба податке од QuizService-а:
- HTTP позив између контејнера на истој EC2 машини
- Серијализација/десеријализација JSON-а
- Процењени overhead: 1-3ms по позиву

**Независне базе података**: Сваки микросервис има своју RDS инстанцу:
- Connection pool management
- Немогућност JOIN операција између база
- Процењени overhead: 1-2ms

**Серијализација података**: Сваки HTTP захтев захтева:
- Серијализацију објеката у JSON
- Десеријализацију JSON-а у објекте
- Процењени overhead: 0.5-1ms

Укупан архитектурни overhead микросервиса (без мрежне латенције до AWS-а) процењује се на **5-11ms** по захтеву.

### 5.5.4 Поређење под једнаким условима

Да би се направило праведно поређење, неопходно је елиминисати фактор географске удаљености. Ако би оба система била deployована локално или оба на AWS-у у истом региону, очекиване вредности би биле:

**Сценарио 1: Оба локално**
- Монолит: ~4.6ms (unchanged)
- Микросервиси: ~15-20ms (server processing + inter-service overhead)
- Разлика: ~3-4x у корист монолита

**Сценарио 2: Оба на AWS-у**
- Монолит: ~125-130ms (мрежна латенција до AWS-а)
- Микросервиси: ~135-145ms (мрежна латенција + inter-service overhead)
- Разлика: ~5-10% у корист монолита

Овај анализа показује да је **мрежна латенција до AWS-а доминантан фактор** (90%+ утицаја), док архитектурне разлике доприносе мањи али још увек значајан overhead од 15-20ms (3-4x спорије).

## 5.6 Скалабилност архитектура

### 5.6.1 Понашање под растућим оптерећењем

Обе архитектуре показују стабилне перформансе под растућим оптерећењем:

**Монолитна архитектура**:
- Време одзива остаје у опсегу 4.6-6.4ms без обзира на оптерећење
- Пропусност расте линеарно са бројем корисника
- Не показује знаке деградације чак ни под тешким оптерећењем (50 корисника)

**Микросервисна архитектура**:
- Време одзива остаје константно ~127-130ms
- Пропусност такође расте линеарно
- Стабилне перформансе без деградације

### 5.6.2 Потенцијал за хоризонтално скалирање

Иако оба система показују добре перформансе у овом тесту, њихов потенцијал за скалирање на много веће оптерећење се разликује:

**Монолитна архитектура**:
- Ограничена на вертикално скалирање (јача машина)
- Може се реплицирати на више инстанци, али са ограничењима
- Једна база података може постати bottleneck

**Микросервисна архитектура**:
- Сваки сервис може се скалирати независно
- Флексибилније хоризонтално скалирање
- Сваки сервис има своју базу података

За оптерећења далеко изнад 50 конкурентних корисника (нпр. стотине или хиљаде), микросервисна архитектура би имала предност јер омогућава независно скалирање критичних компоненти.

## 5.7 Синтеза резултата

### 5.7.1 Кључни налази

На основу спроведених тестова, идентификовани су следећи кључни налази:

1. **Монолитна архитектура има значајно боље перформансе у смислу времена одзива** - 23-27 пута бржа од микросервисне архитектуре у овом тест сценарију.

2. **Мрежна латенција је доминантан фактор** - Више од 90% разлике у перформансама је последица чињенице да је монолит deployован локално, а микросервиси на AWS-у.

3. **Архитектурни overhead микросервиса је умерен** - Када се елиминише географска латенција, процењени overhead је 3-4x (15-20ms vs 4-5ms).

4. **Пропусност је слична** - Разлика у throughput-у је само ~10%, што показује да обе архитектуре ефикасно обрађују конкурентне захтеве.

5. **Обе архитектуре су стабилне** - Перформансе не деградирају под повећаним оптерећењем (5 → 50 корисника).

6. **Разлика у стопи грешака** - Монолит: 0% грешака; Микросервиси: 25% грешака. Разлика је узрокована недостајућим подацима у AWS бази, не архитектуром.

### 5.7.2 Контекстуализација резултата

Важно је напоменути да ови резултати не треба да се тумаче као апсолутна супериорност монолитне архитектуре. Разлози:

**Предности монолита у овом тесту су артифицијелно увећане** јер:
- Deployован је локално (нереалистично за production окружење)
- Нема мрежне латенције
- Једноставан deployment без distributed system изазова

**Микросервиси су тестирани у реалистичнијем сценарију** јер:
- Deployовани на cloud инфраструктури (типично за production)
- Комуникација преко јавног интернета
- Све компоненте distributed system-а су активне

**Под једнаким условима** (оба локално или оба на AWS-у):
- Монолит би и даље био бржи, али разлика би била ~3-4x, не 23x
- За мале до средње апликације, монолит је бољи избор
- За веома велике апликације са стотинама хиљада корисника, микросервиси нуде предности у скалирању и независном deployовању

### 5.7.3 Препоруке на основу резултата

На основу анализе резултата, могу се дати следеће препоруке:

**Користити монолитну архитектуру када**:
- Апликација је мала до средње величине (< 100,000 lines of code)
- Оптерећење је предвидљиво и умерено (< 1000 req/s)
- Тим је мали (< 10 програмера)
- Брзина одзива је критична (real-time апликације)
- Инфраструктурни ресурси и експертиза су ограничени

**Користити микросервисну архитектуру када**:
- Апликација је велика и сложена
- Потребно је независно скалирање различитих компоненти
- Тим је велик и организован у подтимове
- Постоји зрела DevOps култура и инфраструктура
- Толеранција на мрежну латенцију је већа (не real-time)
- Предност је флексибилност и fault isolation над апсолутним перформансама

Коначно, многе савремене апликације користе **хибридни приступ** - почињу као монолит, а критичне компоненте постепено екстрактују у микросервисе како систем расте.
